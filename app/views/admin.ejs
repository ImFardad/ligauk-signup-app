<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>پنل ادمین</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="/css/style.css">
  <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>
</head>
<body class="bg-pattern min-h-screen p-4 relative">

  <!-- دکمه خروج -->
  <button class="logout-btn" onclick="window.location='/logout'">خروج</button>

  <div id="adminApp" class="bg-gray-800 bg-opacity-70 backdrop-blur-lg p-6 rounded-2xl max-w-6xl mx-auto mt-20 flex">

    <!-- اعلان خطا/موفقیت -->
    <div v-if="notification" class="notification">
      {{ notification }}
    </div>

    <!-- منوی کناری -->
    <nav class="w-1/5 text-white pr-4 border-l border-gray-700">
      <ul>
        <li v-for="sec in sections" :key="sec.key"
            @click="activeSection = sec.key"
            class="py-2 px-3 cursor-pointer hover:bg-gray-700 rounded"
            :class="{'bg-gray-700 font-bold': activeSection === sec.key}">
          {{ sec.label }}
        </li>
      </ul>
    </nav>

    <!-- محتوای اصلی -->
    <div class="w-4/5 pl-6 text-white overflow-x-auto">
      <!-- کاربران -->
      <section v-show="activeSection === 'users'">
        <h2 class="text-2xl font-bold mb-4">مدیریت کاربران</h2>
        <input v-model="search" @input="fetchUsers" placeholder="جستجو…" class="search-input mb-4 w-full">
        <table class="admin-table w-full">
          <thead>
            <tr>
              <th class="px-3 py-1">#</th>
              <th class="px-3 py-1">نام</th>
              <th class="px-3 py-1">نام‌خانوادگی</th>
              <th class="px-3 py-1">موبایل</th>
              <th class="px-3 py-1">کد ملی</th>
              <th class="px-3 py-1">ایمیل</th>
              <th class="px-3 py-1">نقش</th>
              <th class="px-3 py-1">فعال</th>
              <th class="px-3 py-1">ذخیره</th>
              <th class="px-3 py-1">حذف</th>
            </tr>
          </thead>
          <tbody>
            <tr v-for="(u, idx) in users" :key="u.id" class="hover:bg-gray-700">
              <td class="border px-3 py-1">{{ idx + 1 }}</td>
              <td class="border px-3 py-1">
                <input v-model="u.firstName" class="input-field w-full text-sm">
              </td>
              <td class="border px-3 py-1">
                <input v-model="u.lastName" class="input-field w-full text-sm">
              </td>
              <td class="border px-3 py-1">
                <input v-model="u.phoneNumber" class="input-field w-full text-sm">
              </td>
              <td class="border px-3 py-1">
                <input v-model="u.nationalId" class="input-field w-full text-sm">
              </td>
              <td class="border px-3 py-1">
                <input v-model="u.email" class="input-field w-full text-sm">
              </td>
              <td class="border px-3 py-1">
                <select v-model="u.role" class="input-field w-full text-sm">
                  <option value="user">کاربر</option>
                  <option value="mentor">منتور</option>
                </select>
              </td>
              <td class="border px-3 py-1 text-center">
                <input type="checkbox" v-model="u.isActive">
              </td>
              <td class="border px-3 py-1 text-center">
                <button class="primary px-2 py-1 text-sm" @click="updateUser(u)">ذخیره</button>
              </td>
              <td class="border px-3 py-1 text-center">
                <button class="danger px-2 py-1 text-sm" @click="deleteUser(u)">حذف</button>
              </td>
            </tr>
          </tbody>
        </table>
      </section>

      <!-- منتورها -->
      <section v-show="activeSection === 'mentors'">
        <h2 class="text-2xl font-bold mb-4">مدیریت منتورها</h2>
        <input v-model="searchMentor" @input="fetchMentors" placeholder="جستجو…" class="search-input mb-4 w-full">
        <table class="admin-table w-full">
          <thead>
            <tr>
              <th class="px-3 py-1">#</th>
              <th class="px-3 py-1">نام</th>
              <th class="px-3 py-1">نام‌خانوادگی</th>
              <th class="px-3 py-1">موبایل</th>
              <th class="px-3 py-1">کد ملی</th>
              <th class="px-3 py-1">ایمیل</th>
              <th class="px-3 py-1">نقش</th>
              <th class="px-3 py-1">فعال</th>
              <th class="px-3 py-1">ذخیره</th>
              <th class="px-3 py-1">حذف</th>
            </tr>
          </thead>
          <tbody>
            <tr v-for="(u, idx) in mentors" :key="u.id" class="hover:bg-gray-700">
              <td class="border px-3 py-1">{{ idx + 1 }}</td>
              <td class="border px-3 py-1">
                <input v-model="u.firstName" class="input-field w-full text-sm">
              </td>
              <td class="border px-3 py-1">
                <input v-model="u.lastName" class="input-field w-full text-sm">
              </td>
              <td class="border px-3 py-1">
                <input v-model="u.phoneNumber" class="input-field w-full text-sm">
              </td>
              <td class="border px-3 py-1">
                <input v-model="u.nationalId" class="input-field w-full text-sm">
              </td>
              <td class="border px-3 py-1">
                <input v-model="u.email" class="input-field w-full text-sm">
              </td>
              <td class="border px-3 py-1">
                <select v-model="u.role" class="input-field w-full text-sm">
                  <option value="user">کاربر</option>
                  <option value="mentor">منتور</option>
                </select>
              </td>
              <td class="border px-3 py-1 text-center">
                <input type="checkbox" v-model="u.isActive">
              </td>
              <td class="border px-3 py-1 text-center">
                <button class="primary px-2 py-1 text-sm" @click="updateUser(u)">ذخیره</button>
              </td>
              <td class="border px-3 py-1 text-center">
                <button class="danger px-2 py-1 text-sm" @click="deleteUser(u)">حذف</button>
              </td>
            </tr>
          </tbody>
        </table>
      </section>

      <!-- بخش‌های خالی -->
      <section v-show="activeSection === 'groups'"><h2 class="text-2xl font-bold">گروه‌ها</h2></section>
      <section v-show="activeSection === 'items'"><h2 class="text-2xl font-bold">آیتم‌ها</h2></section>
      <section v-show="activeSection === 'contents'"><h2 class="text-2xl font-bold">محتواها</h2></section>
    </div>
  </div>

  <script src="/js/admin.js"></script>
</body>
</html>
